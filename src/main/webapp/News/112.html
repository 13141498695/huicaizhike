<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
    <meta http-equiv="Content-Language" content="zh-CN" />
    <meta name="renderer" content="webkit|ie-comp|ie-stand" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no,height=device-height" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta http-equiv="X-UA-Compatible" content="IE=Edge￡?chrome=1" />
    <title>鹿晗和关晓彤是如何联手搞垮新浪微博服务器的？-微信公众号开发_APP开发</title>
    <meta name="keywords" content="微信公众号开发，微信开发，微信小程序，APP开发"/><meta name="description" content="一家专业网站建设公司，为企业提供网站建设，微信开发，微信小程序开发，咨询电话：01085803994" />
    <link rel="Shortcut Icon" href="http://www.xn-design.com.cn/images/ShortcutIcon.ico" />
    <link rel="stylesheet" type="text/css" href="../css/lunbo.css" />
    <link type="text/css" rel="stylesheet" href="../css/style.css" />
    <script type="text/javascript" src="../js/jquery.min.js">d</script>
    <script type="text/javascript" src="../js/zepto.min.js"></script>
    <script type="text/javascript" src="../js/index.js"></script>
    <link rel="stylesheet" type="text/css" href="../css/banner2.css" />
    <script type="text/javascript" src="../js/banner2.js"></script>
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="../../oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

</head>

<body onselectstart="return false" style="background:#FFF; ">


<!-- Copyright ? 2008. Spidersoft Ltd -->
<style>
A.applink:hover {border: 2px dotted #DCE6F4;padding:2px;background-color:#ffff00;color:green;text-decoration:none}
A.applink       {border: 2px dotted #DCE6F4;padding:2px;color:#2F5BFF;background:transparent;text-decoration:none}
A.info          {color:#2F5BFF;background:transparent;text-decoration:none}
A.info:hover    {color:green;background:transparent;text-decoration:underline}
</style>
<div style='BORDER: 1px solid #DCE6F4; MARGIN-TOP: 20px; MARGIN-BOTTOM: 20px; MARGIN-LEFT: 5px; MARGIN-RIGHT: 5px; PADDING: 5px; BACKGROUND-COLOR: #eef8ff;line-height:180%; COLOR: #000000; font-family: Arial; font-size: 8pt; width=100%; FILTER: progid:DXImageTransform.Microsoft.Gradient(GradientType=0, StartColorStr="#FFFFFFFF", EndColorStr="#F2F5FAFF");'>
This page was saved using <a class="applink" href="http://www.spidersoft.com"><b>WebZIP 7.1.2.1052</b></a> <a class="applink" href="http://www.spidersoft.com"><b>offline browser</b></a>  on  11/17/17 11:58:20.<br>
<b>Address:</b> <a class="info" href="http://www.xn-design.com.cn/News/112.html">http://www.xn-design.com.cn/News/112.html</a><br>
<b>Title:</b> 鹿晗和关晓彤是如何联手搞垮新浪微博服务器的？-微信公众号开发_APP开发_信诺盛世 &nbsp;&bull;&nbsp; <b>Size:</b> 45966 &nbsp;&bull;&nbsp; <b>Last Modified:</b> Tue, 17 Oct 2017 02:50:41 GMT<br></div>
<!-- /Copyright ? 2008. Spidersoft Ltd -->


    <div id="header"><div class="div_basic"><h1><a href="../index.html">网站建设|北京网站建设|北京网络公司-信诺盛世</a></h1><ul class="nav"> <li><a href="../index.html" >首页</a></li> <li><a href="../Service/Service.html" >服务</a></li> <li><a href="../Case/Case.html" >案例</a></li> <li><a href="News.html" class="select">资讯</a></li><li><a href="../About/About.html" >关于</a></li><li><a href="../Contact/Contact.html" >联络</a></li><div class="cb"></div></ul> <a class="anniu" href="javascript:;"></a> <div class="cb"></div></div> <ul class="nav_fu"><li><a href="../index.html">首页</a></li> <li><a href="../Service/Service.html">服务</a></li><li><a href="../Case/Case.html">案例</a></li><li><a href="News.html">资讯</a></li><li><a href="../About/About.html">关于</a></li><li><a href="../Contact/Contact.html">联络</a></li></ul></div>
    <!--===  header END  ===-->

    <div id="img-news"></div>

    <div id="zixun">
        <div class="div_basic">
            <ul class="left"> <li> <a href="xyzx/xyzx.html" class="select" ><span>行业资讯</span><span>Industry<b></b></span> </a></li> <li> <a href="gsxw/gsxw.html" ><span>公司新闻</span><span>News<b></b></span> </a></li> <li> <a href="wzchyfa/wzchyfa.html" ><span>网站策划与方案</span><span>Plan<b></b></span> </a></li> <li> <a href="wzzs/wzzs.html" ><span>网站知识</span><span>Web<br />Knowledge<b></b></span> </a></li> <li> <a href="wzsj/wzsj.html" ><span>网站设计</span><span>Web<br />Design<b></b></span> </a></li> <li> <a href="wzgb/wzgb.html" ><span>网站改版</span><span>Web<br />Revision<b></b></span> </a></li> </ul>
            <div class="right">
                <p class="mianbaoxie">
                    <a href="../index.html">首页</a>&nbsp;&gt;&nbsp;<a href="News.html">资讯</a>&nbsp;&gt;&nbsp;<a href="xyzx/xyzx.html">行业资讯</a>&nbsp;&gt;&nbsp;正文
                  
                </p>
                <div class="zixun-xiangxi">
                    <strong>鹿晗和关晓彤是如何联手搞垮新浪微博服务器的？</strong>
                    <div>
                        <span class="fujia">2017-10-11</span>
                        <span class="fujia">阅读：<script src="../click/count.aspx?id=112.html"></script>次</span>
                        <!--<span class="fujia">TAG: </span>-->
                        
                    </div>
               
                    <div class="zixun-xiangxi-dep">
                        <p><p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	不知不觉，美好的十一假期已经结束了。在假期的最后一天，大约有四千万人同时失恋，我们迎来了 2017 年度最大甜蜜暴击！
</p>
<p style="text-align:center;margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;white-space:normal;background-color:#FFFFFF;">
	<img data-s="300,640" data-type="png" data-img="http://mmbiz.qpic.cn/mmbiz_png/MOwlO0INfQr1bmxU0PBAmviaosZibq5RXjQAjV1ZsRpZhNto08mtIN1N4icuknaktWswqfUHuT9epCgJYaDeGj5zQ/0?wx_fmt=png" class="" data-ratio="0.5513428120063191" data-w="633" src="../../upload.chinaz.com/2017/1010/6364322639302544563196401.jpeg.jpg" data-fail="0" style="vertical-align:top;height:auto;max-width:590px;" /> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	鹿晗在新浪微博高调宣布了自己的新恋情，并大方的@了女朋友关晓彤。消息一出，<inherit>微博立马就炸了。</inherit>
</p>
<p style="text-align:center;margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;white-space:normal;background-color:#FFFFFF;">
	<img class="" data-ratio="0.8833333333333333" data-s="300,640" data-img="https://mmbiz.qpic.cn/mmbiz_jpg/1hReHaqafadfvOE0FTQ6wVklLbuSAnNgGfiaVlbrNqibHvKEiaYmvA3ibGyGHnAsWEWrutY9qJ4AIp5V6moIsbBt3w/640?wx_fmt=jpeg" data-type="jpeg" data-w="600" _width="auto" src="../../upload.chinaz.com/2017/1010/6364322639320945615954597.jpeg.jpg" data-fail="0" width="auto" style="vertical-align:top;height:auto;max-width:590px;" /> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	<inherit>短短几个小时之后，该条微博被转发 736137 次、评论 1913926 次、点赞 4179888 次，短时间内</inherit>转发评论点赞分分钟冲上百万，疯狂上涨的数字搞垮了新浪微博的服务器……
</p>
<p style="text-align:center;margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;white-space:normal;background-color:#FFFFFF;">
	<img class="" data-ratio="0.2332695984703633" data-s="300,640" data-img="https://mmbiz.qpic.cn/mmbiz_png/OaFsUa11r0BwKia5l5eD7th4ZF7UBxE9xtlOpqbBvm45cIbJH2dvz04Em961ZUkszy3zp1JpDSEZk3hZtp2tsZw/640?wx_fmt=png" data-type="png" data-w="523" _width="auto" src="../../upload.chinaz.com/2017/1010/6364322639333846353226118.png" data-fail="0" width="auto" style="vertical-align:top;height:auto;max-width:590px;" /> 
</p>
<p style="text-align:center;margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;white-space:normal;background-color:#FFFFFF;">
	<img class="" data-ratio="0.224105461393597" data-s="300,640" data-img="https://mmbiz.qpic.cn/mmbiz_png/OaFsUa11r0BwKia5l5eD7th4ZF7UBxE9xRJ4VlxXTlbfKg5ZgvuqnN9T0ib6wlpXrclQyK2tJygzTU6SBA1kDxIg/640?wx_fmt=png" data-type="png" data-w="531" _width="auto" src="../../upload.chinaz.com/2017/1010/6364322639346447079497640.png" data-fail="0" width="auto" style="vertical-align:top;height:auto;max-width:590px;" /> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	<inherit>终于，</inherit>新浪工程师担心的事情还是出现了：北京时间 10 月 8 日午间 12 时 32 分，新浪微博官方客服账号发布公告称，目前客户端无法正常刷新、评论等多个页面无法正常显示的问题，工程师已在排查。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	对于造成这一问题的具体原因，新浪微博在公告中称“大家心里也都有数”。
</p>
<p style="text-align:center;margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;white-space:normal;background-color:#FFFFFF;">
	<img class="" data-ratio="0.6824877250409165" data-s="300,640" data-img="https://mmbiz.qpic.cn/mmbiz_jpg/5SSkUyMYWI5QBKBUS3SseCgg6QgV5cVfG0uACclQTSUlTVMjcicKcyPMibPicSaib31Frfc0CIGBd6L73rT1dk5bCQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="1222" _width="auto" src="../../upload.chinaz.com/2017/1010/6364322639360047858241744.jpeg.jpg" data-fail="0" width="auto" style="vertical-align:top;height:auto;max-width:590px;" /> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	最后还是老板弄来了一千台服务器才搞定...
</p>
<p style="text-align:center;margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;white-space:normal;background-color:#FFFFFF;">
	<img class="" data-ratio="0.22666666666666666" data-img="https://mmbiz.qpic.cn/mmbiz_jpg/hFB4FUPIIlJJuRQqhefxMrL4P6uolBxYC2Y6BYZNLLHxFU9lLaEV0a66ia8W6EWNBgZiccVyodMY3ic3zzj5e3ibUg/640?wx_fmt=jpeg" data-type="jpeg" data-w="600" _width="auto" src="../../upload.chinaz.com/2017/1010/6364322639374448672284020.jpeg.jpg" data-fail="0" width="auto" style="vertical-align:top;height:auto;max-width:590px;" /> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	然而整个事件当中，除了无数粉碎的少女心，最无辜躺枪还如此敬业的小哥哥，非这位微博搜索工程师丁振凯莫属啦，结婚当日，遇鹿晗公布恋情，不得不从酒席上离开处理微博异常后继续婚礼，心疼小哥哥三秒钟......
</p>
<p style="text-align:center;margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;white-space:normal;background-color:#FFFFFF;">
	<img class="" data-ratio="0.5627118644067797" data-s="300,640" data-img="https://mmbiz.qpic.cn/mmbiz_png/Pn4Sm0RsAuhzN77ENDyE5iap5mibTMvJjgn5laP8oKXHcGKnLic5yK8PvJiaxMzU0dTfaibj2B1jibak0GibuicDxl8m5w/640?wx_fmt=png" data-type="png" data-w="590" _width="auto" src="../../upload.chinaz.com/2017/1010/6364322639388949506798879.jpeg.jpg" data-fail="0" style="vertical-align:top;height:auto;max-width:590px;" /> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	那一刻，被迫加班的程序员内心是这样的：
</p>
<p style="text-align:center;margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;white-space:normal;background-color:#FFFFFF;">
	<img data-s="300,640" data-type="png" data-img="http://mmbiz.qpic.cn/mmbiz_png/MOwlO0INfQr1bmxU0PBAmviaosZibq5RXj0pOiayCqVZI3GgvgM7eYkYBvLl4sYZGTRibJ1E1ksIur6kG14aLOvslQ/0?wx_fmt=png" class="" data-ratio="0.6016666666666667" data-w="600" src="../../upload.chinaz.com/2017/1010/6364322639401450228772229.jpeg.jpg" data-fail="0" style="vertical-align:top;height:auto;max-width:590px;" /> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	连今天的淘宝程序猿都是失恋了：
</p>
<p style="text-align:center;margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;white-space:normal;background-color:#FFFFFF;">
	<img class="" data-ratio="1.7375" data-s="300,640" data-img="https://mmbiz.qpic.cn/mmbiz_jpg/yiaicHBv21TOwCicGkZziaO5m3J933W35NQg6q0z84dkiaiaaib0ibIGu5Enfk32Vx0nuxzFYtYLk730yIuF0uia7Bt5kZw/640?wx_fmt=jpeg" data-type="jpeg" data-w="720" _width="auto" src="../../upload.chinaz.com/2017/1010/6364322639413350904571168.jpeg.jpg" data-fail="0" style="vertical-align:top;height:auto;max-width:590px;" /> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	微博工程师眼中的「鹿晗」：
</p>
<p style="text-align:center;margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;white-space:normal;background-color:#FFFFFF;">
	<img data-ratio="0.5040322580645161" data-img="https://mmbiz.qpic.cn/mmbiz_gif/gTGiciaYsZLQoEtGIlUUygN2j9icHPsfdtsM5dg5ciaC05uyK9RdoNAE5XG6OtEsickZN0ib7ut3U5kobPqfzObM0d4A/0?wx_fmt=gif" data-type="gif" data-w="496" _width="auto" src="../../upload.chinaz.com/2017/1010/6364322639430151861558609.gif" data-order="0" data-fail="0" style="vertical-align:top;height:auto;max-width:590px;" /> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	好的，言归正传，新浪服务器到底是怎么垮的？
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	<br />
</p>
<h3 style="margin:28px 0px 14px;color:#363636;padding-left:15px;border-left:5px solid #FFC81F;background-color:#FFFFFF;text-align:center;font-size:24px;font-family:Tahoma, Arial, &quot;line-height:32px;white-space:normal;">
	新浪服务器是怎么垮的？
</h3>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	<span style="font-weight:700;">知友：苏莉安（200+ 赞，程序员话题优秀回答者）</span> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	我觉得不像数据库挂了，微博这种级别的架构根本不是简单的分布式 server+DB 就能抗住的，别说鹿晗关晓彤搞个大新闻，就算平时运营的压力也扛不住。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	刚才王高飞说加一千台服务器暂时顶住了，数据库是不可能临时这么弹性伸缩的，能伸缩的无非就是 HTTP Server、各中间层服务、缓存或消息队列。
</p>
<p style="text-align:center;margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;white-space:normal;background-color:#FFFFFF;">
	<img class="" data-ratio="0.22666666666666666" data-img="https://mmbiz.qpic.cn/mmbiz_jpg/WKtM9X8hT26SYHeclk8aOaNKTQRC6PGV768lniatzsC01CvlFsbFQZeZleHEEEhFMaiar2LyzQdIRmX3dpA2LUVQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="600" _width="auto" src="../../upload.chinaz.com/2017/1010/6364322639454853275101652.jpeg.jpg" data-fail="0" style="vertical-align:top;height:auto;max-width:590px;" /> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	大概是微博自动扩容的算法没写好，或者没敢全交给算法来做。比如你发现流量升高了，自动下单加几十台服务器能接受，突然加一千台要是程序出 Bug 的话微博得白支出多少钱啊……多半是这个量级的扩容需要运维手工来确认。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	而且是在长假最后一天的中午爆发的，不是访问高峰期，服务器也准备不足。明星公布恋情这件事又没法预警，谁知道他们啥时候心血来潮忽然介绍女朋友啊……
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	<span style="font-weight:700;">知友（400+ 赞）</span> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	根据目前已有的信息猜测是数据库被压垮了，先发猜想，稍后写个程序分析当时的点赞评论转发数据验证猜想。微博这样的网站，如果被大流量压垮，不太可能是非必需字段没有容错。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	之前经历过几次热门事件，我相信在爆发热点新闻的时候，微博会暂时牺牲一点数据准确性来保证关键服务可用，也就是说，光读请求很难压垮微博。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	根据事故时的微博点赞数、转发数、评论数、评论的回复数、评论的点赞数、转发的评论转发点赞数等的量，微博极可能是由于事发当时需要写入数据库的请求太多（写行为峰值可能达到了几十万甚至更高），以及大部分写都会落到同一条微博上，而且某些写操作还需要触发相应的其他写行为（回复评论需要通知评论者、点赞需要进关注者 feed 等），数据库压力过大扛不过来，最终跪了一会儿。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	其实如果缓存做好，这时候还是可以满足核心数据读请求的（当然微博缓存做的并不好，我微博个人页数据错误很久了反馈也没用）。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	如果数据库压力过大时，对部分写请求异步化，或者考虑暂时抛弃部分请求换取稳定性，当然这样也各有利弊，不一定是好的。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	可以抓取当时鹿晗发的微博的所有评论转发回复点赞的时间，看下故障前几秒成功的写行为究竟有多少。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	不负责任的未经验证的猜测（画图水平有限，省略了部分过程，但是从上下两个过度的箭头数，大致表达了很多请求是读且未压到数据库，将就看吧：
</p>
<p style="text-align:center;margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;white-space:normal;background-color:#FFFFFF;">
	<img class="" data-ratio="2.0555555555555554" data-s="300,640" data-img="https://mmbiz.qpic.cn/mmbiz_jpg/k1lLFZEXyalGF2LdXdCuWMm7NGh4eKm39iclTl60bRlqjkQxKS6s0MGel9nsnIVhKibz5cst14n1oj467JF0h3Og/640?wx_fmt=jpeg" data-type="jpeg" data-w="720" _width="auto" src="../../upload.chinaz.com/2017/1010/6364322639468654063845756.jpeg.jpg" data-fail="0" style="vertical-align:top;height:auto;max-width:590px;" /> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;white-space:normal;background-color:#FFFFFF;">
	<span style="font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">让我放两张来自微博后台数据的图片：</span> 
</p>
<p style="text-align:center;margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;white-space:normal;background-color:#FFFFFF;">
	<img class="" data-ratio="0.6466666666666666" data-img="https://mmbiz.qpic.cn/mmbiz_jpg/WKtM9X8hT26SYHeclk8aOaNKTQRC6PGVicL1hSnic8N6lhxlFAEBP5EibEmxQia8RiaLOktILfIORlRPT6NibbP3noLQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="600" _width="auto" src="../../upload.chinaz.com/2017/1010/6364322639482254841117278.jpeg.jpg" data-fail="0" style="vertical-align:top;height:auto;max-width:590px;" /> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	这样看可能不是很直观？
</p>
<p style="text-align:center;margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;white-space:normal;background-color:#FFFFFF;">
	<img class="" data-ratio="0.6483333333333333" data-img="https://mmbiz.qpic.cn/mmbiz_jpg/WKtM9X8hT26SYHeclk8aOaNKTQRC6PGVWm7HibvO02bFb12IW9anHYk99ias39VSdFXibTcsfwz2j7VQQSU5BJPpQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="600" _width="auto" src="../../upload.chinaz.com/2017/1010/6364322639494955567388799.jpeg.jpg" data-fail="0" style="vertical-align:top;height:auto;max-width:590px;" /> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	没有对比就没有伤害啊！关晓彤热议趋势硬生生涨了 1122.9%，社会社会！
</p>
<p style="text-align:center;margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;white-space:normal;background-color:#FFFFFF;">
	<img class="" data-ratio="1.0586206896551724" data-s="300,640" data-img="https://mmbiz.qpic.cn/mmbiz_jpg/WKtM9X8hT26SYHeclk8aOaNKTQRC6PGVPxCvbFczTk22SJaGPCICLOfYcqT4VIx07ztJic38QO4T59IkPzRQunQ/640?wx_fmt=jpeg" data-type="jpeg" data-w="290" _width="249px" src="../../upload.chinaz.com/2017/1010/6364322639507956316132903.jpeg.jpg" data-fail="0" width="249" height="264" style="vertical-align:top;height:auto;max-width:590px;" /> 
</p>
<h3 style="margin:28px 0px 14px;color:#363636;padding-left:15px;border-left:5px solid #FFC81F;background-color:#FFFFFF;text-align:center;font-size:24px;font-family:Tahoma, Arial, &quot;line-height:32px;white-space:normal;">
	如何快速提高系统性能？
</h3>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	回顾一下，究竟是多大的流量使得曾豪言“微博服务器稳定，能同时应付三对劈腿的”壮志秒破功，具体数据如下图所示：
</p>
<p style="text-align:center;margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;white-space:normal;background-color:#FFFFFF;">
	<img class="" data-ratio="0.42700156985871274" data-s="300,640" data-img="https://mmbiz.qpic.cn/mmbiz_png/Pn4Sm0RsAuhzN77ENDyE5iap5mibTMvJjgVz1g4Dib6fiaeBiblbzKMNZrCUAusibX346vT3AfMa4cHSnTDUSnwFyCicg/640?wx_fmt=png" data-type="png" data-w="637" _width="auto" src="../../upload.chinaz.com/2017/1010/6364322639521057063404425.png" data-fail="0" style="vertical-align:top;height:auto;max-width:590px;" /> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	按照微博明星势力榜各个榜单计分方式：满分 100 分，由阅读数、互动数、社会影响力、爱慕值四项组成，所占比例分别为30%、30%、20%、20%。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	由上可以看出，鹿晗所发微博的每一项都达到了峰值，那么在如此高流量的情况之下，作为开发者是否有好的方法来快速提高系统性能呢？就鹿晗宣布恋情导致微博宕机事件浅谈大型网站高可用性架构。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	作为一名程序员，我更感兴趣的是微博如何应对瞬时涌来的高并发大流量。从很久很久以前文章马伊?P的 “周一见”，到后来 “出轨队”、“吸毒队” 的争相夺分，再到前段时间的郭敬明事件、薛之谦事件，再到今天的鹿晗宣布恋情......&nbsp;
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	微博看似每次都在挂，一直都没有进步，大家每次遇到热点事件刷不出内容的时候都会吐槽微博的应用平台很辣鸡。但是呢，微博的后台系统肯定一直在重构升级优化，我觉得能够做到今天这种水平已经很不错了。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;white-space:normal;background-color:#FFFFFF;text-align:center;">
	<span style="font-weight:700;">01</span><span style="font-weight:700;">从用户的角度（主要是我的角度 hhhhh）来看</span> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	遇到热点事件的时候微博大概率在短时间内（大约 10~15）可能会完全刷不出内容，过了一段时间之后（大约半小时）进行间隔刷新（间隔 10 秒左右），有可能某些时候会看到 5xx 的 error，5 开头的 http 状态码代表服务器或者是网关存在问题。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	比如说服务器拒绝连接、网关超时或者是应用代码存在 Bug 等都会导致 5xx 的错误。在热点事件发生 1 小时内，系统应该可以恢复正常的服务。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;white-space:normal;background-color:#FFFFFF;text-align:center;">
	<span style="font-weight:700;">02</span><span style="font-weight:700;">从网站开发、运维人员的角度来看</span> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	运维：卧槽？怎么访问流量这么高？是出啥 Bug 了吗？卧槽！不会是又有人出轨吸毒了吧？emmmm.... 我的国庆假期可还没结束啊！
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	运维：兄弟们，快醒醒！快加机器啊！系统要崩了！
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	开发：别催！再催自杀！
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	leader：测试在扩容之后赶紧拉出来测测！
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	测试：人在家中躺，锅从天上来！
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	上面都是我乱说的！
</p>
<p style="text-align:center;margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;white-space:normal;background-color:#FFFFFF;">
	<img class="" data-ratio="1" data-s="300,640" data-img="https://mmbiz.qpic.cn/mmbiz_jpg/pJE78Atczrl8fNZ9cf78CqdEtxLksFd4BoK0GEsUT5FwyDDvDDeibiaC1uxmnsRwBIgQejozw5KVBsCSB2U8SGTA/640?wx_fmt=jpeg" data-type="jpeg" data-w="560" _width="309px" src="../../upload.chinaz.com/2017/1010/6364322639532757739675946.jpeg.jpg" data-fail="0" width="309" height="309" style="vertical-align:top;height:auto;max-width:590px;" /> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	为什么我觉得微博在高并发大流量访问方面的表现已经很不错了呢？举个例子吧：淘宝每年在双 11 购物节的时候也要应对高并发的场景，但是这是可以提前做很多准备的。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	比如说提前购买带宽资源、增加服务器资源、进行完备的异地容灾等等，很多都是可预测的。而微博呢？热点事件随时都可能发生，所以这对于微博的运维工程师来说是很大的考验。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	当然，现在的运维平台也是非常的智能了，可以对各项指标进行实时监控，一有异常，马上进行短信或者邮件报警，之后就是各个岗位的工程师人肉上场调配各类资源了。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	那微博在平时为什么不增加一些服务器资源呢？服务器资源、网络带宽资源等既重要，又昂贵。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	由于并不是每时每刻都必须应对高并发的场景，因此如果说在平时增加了冗余的服务器资源导致大量机器空载，也是一种很大的浪费。我们在考虑提供可用服务的同时，也必须考虑一下成本。下面我就针对高可用性架构中经常会提到的几个点来讲讲。
</p>
<h3 style="margin:28px 0px 14px;color:#363636;padding-left:15px;border-left:5px solid #FFC81F;background-color:#FFFFFF;text-align:center;font-size:24px;font-family:Tahoma, Arial, &quot;line-height:32px;white-space:normal;">
	大型网站高可用架构
</h3>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	不管是对于小型网站还是大型网站来说，分层都是必须的：粗粒度的分层一般为应用层、业务层和数据层。横向分层之后，可能还会根据模块的不同对每一层进行纵向的分割。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	拿微博举例，我觉得它的评论模块和点赞模块应该是解耦的。越是复杂的系统，横向和纵向的分层分割粒度就会越细。很多时候你用起来以为它就是一个系统，其实后面可能是由几百上千个独立部署的系统对外提供服务。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	<span style="font-weight:700;">集群</span> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	集群在大型网站架构中是一个非常非常重要的概念。由于服务器（不管是应用服务器还是数据服务器）容易发生单点问题，一旦一台服务器挂了，就必须进行失效转移。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	<span style="font-weight:700;">应用服务器集群</span> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	一般来说，应用服务器必须是无状态的。什么叫无状态服务器呢？在介绍它之前，我们先来说一下状态服务器：状态服务器一般会保存请求相关的信息，每个请求会默认地使用以前的请求信息。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	这样就很容易导致会话粘滞问题：如果一台状态服务器宕机了，那么它保存的请求信息 (例如 session) 就丢失了，可能会导致不可预知的问题。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	那么相对的，无状态服务器就不保存请求信息，它处理的客户信息必须由请求自己携带，或者是从其他服务器集群获取。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	因此无状态服务器相对于状态服务器来说更加地健壮，就算是重启服务器甚至是服务器宕机都不会丢失状态。由此引申出来的另一个优点就是方便扩容：只要在增加的服务器上部署相同的应用并做好反向代理就能对外提供正常的服务。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	<span style="font-weight:700;">Session 管理</span> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	既然应用服务器是无状态的，那么用户的登录信息 (session) 如何管理呢？比较常见的有下面四种方式：
</p>
<ul style="padding:0px 0px 0px 20px;list-style-position:initial;list-style-image:initial;margin:0px 0px 24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	<li>
		<p style="margin-top:0px;margin-bottom:0px;">
			session 复制
		</p>
	</li>
	<li>
		<p style="margin-top:0px;margin-bottom:0px;">
			源地址 hash（session 绑定）
		</p>
	</li>
	<li>
		<p style="margin-top:0px;margin-bottom:0px;">
			用 cookie 记录 session
		</p>
	</li>
	<li>
		<p style="margin-top:0px;margin-bottom:0px;">
			session 服务器
		</p>
	</li>
</ul>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	但是由于前三种都有很大的局限性，这里只聊聊基于集群的 session 服务器管理方式。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	我们在这里是将服务器的状态进行分离：分为无状态的应用服务器和有状态的 session 服务器。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	当然，这里说的 session 服务器肯定说的是 session 服务器集群。我们可以借助分布式缓存或者是关系型数据库来存储 session。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	对于微博来说，这里肯定得用分布式缓存了：因为用关系型数据库的话，数据库连接资源容易成为瓶颈，并且 I/O 操作也很耗时间。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	比较常见的 K-V 内存数据库有 Redis。我觉得微博内容中的赞数、用户的关注数和粉丝数用 Redis 来存应该算是比较合适的。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;white-space:normal;background-color:#FFFFFF;">
	<span style="font-weight:700;">负载均衡</span> 
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	既然提到了集群，肯定得说说负载均衡。但是感觉负载均衡应该可以归类到可伸缩性里面去，所以这里就不详细讲啦，就简单说说有哪些常见的负载均衡的方式以及负载均衡算法。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	<span style="font-weight:700;">负载均衡方式：</span> 
</p>
<ul style="padding:0px 0px 0px 20px;list-style-position:initial;list-style-image:initial;margin:0px 0px 24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	<li>
		<p style="margin-top:0px;margin-bottom:0px;">
			HTTP 重定向负载均衡。
		</p>
	</li>
	<li>
		<p style="margin-top:0px;margin-bottom:0px;">
			DNS 域名解析负载均衡。
		</p>
	</li>
	<li>
		<p style="margin-top:0px;margin-bottom:0px;">
			反向代理负载均衡。
		</p>
	</li>
	<li>
		<p style="margin-top:0px;margin-bottom:0px;">
			IP 负载均衡。
		</p>
	</li>
	<li>
		<p style="margin-top:0px;margin-bottom:0px;">
			数据链路层负载均衡。
		</p>
	</li>
</ul>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	<span style="font-weight:700;">负载均衡算法：</span> 
</p>
<ul style="padding:0px 0px 0px 20px;list-style-position:initial;list-style-image:initial;margin:0px 0px 24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	<li>
		<p style="margin-top:0px;margin-bottom:0px;">
			轮询法。
		</p>
	</li>
	<li>
		<p style="margin-top:0px;margin-bottom:0px;">
			随机法。
		</p>
	</li>
	<li>
		<p style="margin-top:0px;margin-bottom:0px;">
			源地址哈希。
		</p>
	</li>
	<li>
		<p style="margin-top:0px;margin-bottom:0px;">
			加权轮询。
		</p>
	</li>
	<li>
		<p style="margin-top:0px;margin-bottom:0px;">
			加权随机。
		</p>
	</li>
	<li>
		<p style="margin-top:0px;margin-bottom:0px;">
			最小连接数。
		</p>
	</li>
</ul>
<h3 style="margin:28px 0px 14px;color:#363636;padding-left:15px;border-left:5px solid #FFC81F;background-color:#FFFFFF;text-align:center;font-size:24px;font-family:Tahoma, Arial, &quot;line-height:32px;white-space:normal;">
	插播点别的
</h3>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	突然想到一个比较有意思的东西：在微博的架构中，应该采用的是异步拉模型而不是同步推模型。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	什么意思呢？我们举个例子：鹿晗的粉丝有 3000 多万，关晓彤的粉丝有 1000 多万。假如他俩发了条微博的同时需要往这 4000 万粉丝的内容列表中 (假设这里用的是关系型数据库) 推送过去，这就是简化的同步推模型。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	那这样有什么缺点呢？首先，这样会消耗大量的数据库连接资源，更重要的是这样不太符合软件设计规范：因为对于两人的粉丝来说，分别由有 3000 多万和 1000 多万的数据是冗余的。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	假如说陈赫、邓超在第一时间对他俩的微博进行了点赞，此时瓶颈就来了：刚才往数据库里插入 4000 多万感觉还可以接受，但是现在四人的粉丝数加起来好几亿了，同时往数据库插这么多数据是不是感觉不太合适？
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	没关系，我们现在换一种内容推送方式：我们现在不用同步推了，而是用异步拉。我们每次在手机上刷微博的时候，如果想要看到更新的内容是不是都要下拉刷新获取？没错这就是异步拉。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	异步拉有什么好处呢？很明显的一个好处就是可以将热点数据进行集中管理，并且不用进行大量的数据插入冗余操作。另外对系统资源的消耗也较少。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	那么微博内容从哪里拉呢？主流的解决方案是把热点内容放到缓存中，每次都去查缓存，这样可以减少 I/O 操作并且避免发生因资源枯竭造成的超时问题。
</p>
<p style="margin-top:0px;margin-bottom:24px;color:#0E0E0E;font-family:Arial, &quot;font-size:16px;text-align:justify;white-space:normal;background-color:#FFFFFF;">
	其实高可用性架构还包括服务升级、服务降级、数据备份、失效转移等等。关于网站高可用、高性能、高拓展方面感觉还有很多很多东西来写。但是有些知识没有一定的实践经验呢，又不能很好的掌握。
</p>
<p>
	<br />
</p></p>
                    </div>
                    <div class="zixun-fenxiang">
                        <!--<a href="javascript:;">分享到微博</a>&nbsp;&nbsp;<a href="javascript:;">分享到微信</a>-->
                        <!-- JiaThis Button BEGIN -->
                        <div class="jiathis_style">
                            <!--<a class="jiathis_button_qzone"></a>-->
                            <a class="jiathis_button_tsina">分享到微博</a>
                            <!--<a class="jiathis_button_tqq"></a>-->
			    &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
                            <a class="jiathis_button_weixin">分享到微信</a>
                            <!--<a class="jiathis_button_renren"></a>
                            <a class="jiathis_button_xiaoyou"></a>
                            <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
                            <a class="jiathis_counter_style"></a>-->
                        </div>
                        <style>
                           .zixun-fenxiang .jiathis_style  .separator, 
                           .zixun-fenxiang .jiathis_style .jiathis_separator{
                               float: none;
                               padding: 0 !important;
                               margin: 0;
                               font-size: 14px;
                               color: #666666;
                               text-align: center;
                               display: inline-block !important;
                               height: 38px !important;
                               line-height: 38px !important;
                               background: none;
                           }
                           .zixun-fenxiang a:hover span{
                                color: #FFF !important;
                                opacity: 1 !important;
                            }
                            .zixun-fenxiang .jiathis_style{
                                float: none;
                                padding: 16px 0 0 0;
                            }
                        </style>
                        <div class="cb"></div>
                        <script type="text/javascript" src="../../v3.jiathis.com/code_mini/jia.js" charset="utf-8"></script>
                        <!-- JiaThis Button END -->
                    </div>
                    <div class="xiangguan">
                        <p class="xiangguan-title"><strong>相关文章</strong></p>
                        <ul>
                             <li> <a href="112.html"> <img src="../UploadFiles/20171011/2017101110080001.jpg" /> <p>鹿晗和关晓彤是如何联手搞垮新浪微博服务器的？</p> </a> </li> <li> <a href="111.html"> <img src="../UploadFiles/20171011/2017101109524189.jpg" /> <p>10万+的付费专栏是如何炼成的？</p> </a> </li> <li> <a href="109.html"> <img src="../UploadFiles/20171011/2017101109313651.jpg" /> <p>做了微信公众号，还需要再做一个app吗？</p> </a> </li> <li> <a href="20.html"> <img src="../UploadFiles/20160604/2016060417385303.jpg" /> <p>优步放狠话：明年要在中国市场超过滴滴</p> </a> </li>
                            <div class="cb"></div>
                        </ul>
                    </div>
                </div>
            </div>
            <div class="cb"></div>
        </div>
    </div>

    <div id="contectUs"><div class="div_basic"><img class="title-img" src="../images/contentUs.jpg" alt=""><div class="contectUs-list"><div> <dl><dt>工作时间</dt><dd>周一至周五 9：00-18:00</dd> </dl> <dl> <dt>工作时间咨询电话</dt><dd>010-85951131 010-85803994</dd> </dl> <dl> <dt>节假日咨询电话</dt><dd>13811859369 Mr.李/15811231591 Mr.殷</dd> </dl> <div class="cb"></div></div><div> <dl> <dt>我们的地址</dt> <dd>北京市朝阳区东四环中路东区国际3号楼2402 <!--百度商桥--> <div style="display:none;"> <script type="text/javascript">     var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");     document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F51ca486d429d63acda9fda10a99917a8' type='text/javascript'%3E%3C/script%3E")); </script> </div></dd></dl> <dl> <dt>点击按钮在线咨询</dt> <dd> <a href="http://wpa.qq.com/msgrd?v=3&uin=344872759&site=qq&menu=yes" target="_blank">客服NO.1</a> <a href="http://wpa.qq.com/msgrd?v=3&uin=458905026&site=qq&menu=yes" target="_blank">客服NO.2</a> <a href="http://wpa.qq.com/msgrd?v=3&uin=664328759&site=qq&menu=yes" target="_blank">客服NO.3</a></dd></dl><dl><dt>我们的联络邮箱</dt><dd>office@xn-design.com.cn</dd></dl><div class="cb"></div></div> </div>  </div></div><div id="rightFloat"> <a href="javascript:;" id="backtotop"><img src="../images/right-top.png" alt=""></a> <a href="http://p.qiao.baidu.com/cps/chatIndex?reqParam=%7B%22from%22%3A0%2C%22sid%22%3A%22-100%22%2C%22tid%22%3A%22-1%22%2C%22ttype%22%3A1%2C%22siteId%22%3A%222314703%22%2C%22userId%22%3A%222584365%22%7D" class="sildeLeft"  target="_blank"><img src="../images/right-kefu.png" alt="">在线客服</a> <a href="http://qiao.baidu.com/v3/?module=default&controller=webim&action=index&siteid=2314703&lastsubid=&from=%E5%8C%97%E4%BA%AC&bid=04e98b7df09076d0749da5f0&chattype=3" class="sildeLeft"  target="_blank"><img src="../images/right-qq.png" alt="">QQ咨询</a> <a href="http://p.qiao.baidu.com/cps/chatIndex?reqParam=%7B%22from%22%3A0%2C%22sid%22%3A%22-100%22%2C%22tid%22%3A%22-1%22%2C%22ttype%22%3A1%2C%22siteId%22%3A%222314703%22%2C%22userId%22%3A%222584365%22%7D" class="sildeLeft"  target="_blank"><img src="../images/right-phone.png" alt="">010-85951131</a> <a href="javascript:;" id="erweima"> <img src="../images/right-erweima.png" alt=""> </a> <span class="erweima"><img src="../UploadFiles/20160604/2016060415020706.jpg"></span></div><div id="fix-footer"><ul class="fix-footer-list"><li><a href="../index.html"><div class="list-dep"><img src="http://www.xn-design.com.cn/footer-svg/index.svg"  /><p>首页</p></div></a></li><li><a href="../Case/Case.html"><div class="list-dep"><img src="http://www.xn-design.com.cn/footer-svg/fenlei.svg"/><p>案例</p></div></a></li><li class="footer-more"><a href="#"><div><img src="http://www.xn-design.com.cn/footer-svg/more.svg"/></div></a></li><li><a href="http://p.qiao.baidu.com/cps/chatIndex?reqParam=%7B%22from%22%3A0%2C%22sid%22%3A%22-100%22%2C%22tid%22%3A%22-1%22%2C%22ttype%22%3A1%2C%22siteId%22%3A%222314703%22%2C%22userId%22%3A%222584365%22%7D"><div class="list-dep"><img src="http://www.xn-design.com.cn/footer-svg/kefu.svg"  /><p>客服</p></div></a></li><li><a href=""><div class="list-dep"><img src="http://www.xn-design.com.cn/footer-svg/phone.svg"  /><p>电话</p></div></a></li><div class="clear"></div></ul></div>
    <!--===  óò2à???ˉ END  ===-->
    <script src="../js/main.js"></script>
    
<!--í3??′ú??-->  
<div style="display:none;">
<script src="https://s95.cnzz.com/z_stat.php?id=1259620538&web_id=1259620538" language="JavaScript"></script>
</div>
</body>
</html>

